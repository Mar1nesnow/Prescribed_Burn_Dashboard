<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prescribed Burn Weather Dashboard - Coon Rapids, IA</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      @keyframes windFlow {
        0% {
          opacity: 0;
          transform: translate(calc(-50% + var(--start-x, 0px)), calc(-50% + var(--start-y, 0px))) scale(0.5);
        }
        50% {
          opacity: 0.8;
        }
        100% {
          opacity: 0;
          transform: translate(calc(-50% + var(--end-x, 0px)), calc(-50% + var(--end-y, 0px))) scale(1.2);
        }
      }
      
      @keyframes windParticle {
        0% {
          opacity: 0;
        }
        10% {
          opacity: 0.6;
        }
        90% {
          opacity: 0.6;
        }
        100% {
          opacity: 0;
        }
      }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
const { useState, useEffect } = React;

// Icon components
const Flame = ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"/></svg>;
const Wind = ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M17.7 7.7a2.5 2.5 0 1 1 1.8 4.3H2"/><path d="M9.6 4.6A2 2 0 1 1 11 8H2"/><path d="M12.6 19.4A2 2 0 1 0 14 16H2"/></svg>;
const Droplets = ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z"/><path d="M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97"/></svg>;
const Thermometer = ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z"/></svg>;
const Eye = ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>;
const AlertTriangle = ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/><line x1="12" x2="12" y1="9" y2="13"/><line x1="12" x2="12.01" y1="17" y2="17"/></svg>;

const PrescribedBurnDashboard = () => {
  const [weatherData, setWeatherData] = useState(null);
  const [forecast, setForecast] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);
  const [mapOffset, setMapOffset] = useState({ x: 0, y: 0 });
  const [isDragging, setIsDragging] = useState(false);
  const [dragStart, setDragStart] = useState({ x: 0, y: 0 });
  const [windParticles, setWindParticles] = useState([]);

  const LAT = 41.8711;
  const LON = -94.6778;

  useEffect(() => {
    fetchWeatherData();
  }, []);
  
  useEffect(() => {
    // Generate wind particles when wind data is available
    if (weatherData?.windSpeed?.value && weatherData?.windDirection?.value) {
      generateWindParticles();
    }
  }, [weatherData]);
  
  const generateWindParticles = () => {
    const particles = [];
    const gridSize = 40; // Distance between particle starting points
    const mapWidth = 400;
    const mapHeight = 320;
    
    for (let x = -200; x < mapWidth; x += gridSize) {
      for (let y = -200; y < mapHeight; y += gridSize) {
        // Add some randomness to make it look more natural
        const offsetX = (Math.random() - 0.5) * 20;
        const offsetY = (Math.random() - 0.5) * 20;
        particles.push({
          id: `${x}-${y}`,
          startX: x + offsetX,
          startY: y + offsetY,
          delay: Math.random() * 3
        });
      }
    }
    setWindParticles(particles);
  };
  
  const handleMouseDown = (e) => {
    setIsDragging(true);
    setDragStart({ x: e.clientX - mapOffset.x, y: e.clientY - mapOffset.y });
  };
  
  const handleMouseMove = (e) => {
    if (isDragging) {
      setMapOffset({
        x: e.clientX - dragStart.x,
        y: e.clientY - dragStart.y
      });
    }
  };
  
  const handleMouseUp = () => {
    setIsDragging(false);
  };
  
  const handleTouchStart = (e) => {
    const touch = e.touches[0];
    setIsDragging(true);
    setDragStart({ x: touch.clientX - mapOffset.x, y: touch.clientY - mapOffset.y });
  };
  
  const handleTouchMove = (e) => {
    if (isDragging) {
      const touch = e.touches[0];
      setMapOffset({
        x: touch.clientX - dragStart.x,
        y: touch.clientY - dragStart.y
      });
    }
  };
  
  const handleTouchEnd = () => {
    setIsDragging(false);
  };

  const fetchWeatherData = async () => {
    try {
      setLoading(true);
      setError(null);
      
      const pointResponse = await fetch(
        `https://api.weather.gov/points/${LAT},${LON}`,
        {
          headers: {
            'User-Agent': 'PrescribedBurnDashboard/1.0',
            'Accept': 'application/geo+json'
          }
        }
      );
      
      if (!pointResponse.ok) {
        throw new Error('Unable to connect to weather service. Status: ' + pointResponse.status);
      }
      
      const pointData = await pointResponse.json();
      
      const stationsResponse = await fetch(pointData.properties.observationStations, {
        headers: {
          'User-Agent': 'PrescribedBurnDashboard/1.0',
          'Accept': 'application/geo+json'
        }
      });
      const stationsData = await stationsResponse.json();
      
      if (!stationsData.features || stationsData.features.length === 0) {
        throw new Error('No weather stations found near this location');
      }
      
      const nearestStation = stationsData.features[0].id;
      
      const obsResponse = await fetch(`${nearestStation}/observations/latest`, {
        headers: {
          'User-Agent': 'PrescribedBurnDashboard/1.0',
          'Accept': 'application/geo+json'
        }
      });
      
      if (!obsResponse.ok) {
        throw new Error('Unable to get current observations');
      }
      
      const obsData = await obsResponse.json();
      
      const forecastResponse = await fetch(pointData.properties.forecastHourly, {
        headers: {
          'User-Agent': 'PrescribedBurnDashboard/1.0',
          'Accept': 'application/geo+json'
        }
      });
      
      if (!forecastResponse.ok) {
        throw new Error('Unable to get forecast data');
      }
      
      const forecastData = await forecastResponse.json();
      
      setWeatherData(obsData.properties);
      setForecast(forecastData.properties.periods);
      setLoading(false);
    } catch (err) {
      console.error('Weather fetch error:', err);
      setError('Failed to fetch weather data: ' + err.message);
      setLoading(false);
    }
  };

  const celsiusToFahrenheit = (celsius) => {
    if (celsius === null) return null;
    return (celsius * 9/5) + 32;
  };

  const metersPerSecondToMph = (mps) => {
    if (mps === null) return null;
    return mps * 2.237;
  };

  const calculateBurnConditions = () => {
    if (!weatherData) return { status: 'unknown', color: 'bg-gray-500', message: 'Loading...' };
    
    const temp = celsiusToFahrenheit(weatherData.temperature.value);
    const humidity = weatherData.relativeHumidity.value;
    const windSpeed = metersPerSecondToMph(weatherData.windSpeed.value);
    
    if (!temp || !humidity || !windSpeed) {
      return { status: 'unknown', color: 'bg-gray-500', message: 'Waiting for data...', issues: [] };
    }
    
    let score = 0;
    let issues = [];
    
    if (temp >= 45 && temp <= 65) score += 33;
    else if (temp < 35 || temp > 75) issues.push('Temperature out of ideal range');
    
    if (humidity >= 25 && humidity <= 55) score += 33;
    else if (humidity < 20) issues.push('Humidity too low (increased fire risk)');
    else if (humidity > 60) issues.push('Humidity too high (may affect ignition)');
    
    if (windSpeed >= 5 && windSpeed <= 15) score += 34;
    else if (windSpeed < 3) issues.push('Wind too calm (smoke dispersal issues)');
    else if (windSpeed > 20) issues.push('Wind too strong (control risk)');
    
    if (score >= 80) {
      return { status: 'Excellent', color: 'bg-green-500', message: 'Ideal conditions for prescribed burn', issues };
    } else if (score >= 50) {
      return { status: 'Acceptable', color: 'bg-yellow-500', message: 'Conditions acceptable with caution', issues };
    } else {
      return { status: 'Poor', color: 'bg-red-500', message: 'Conditions not recommended', issues };
    }
  };

  const getWindDirection = (degrees) => {
    if (!degrees) return 'N/A';
    const directions = ['N', 'NNE', 'NE', 'ENE', 'E', 'ESE', 'SE', 'SSE', 'S', 'SSW', 'SW', 'WSW', 'W', 'WNW', 'NW', 'NNW'];
    return directions[Math.round(degrees / 22.5) % 16];
  };

  if (loading) {
    return (
      <div className="min-h-screen bg-gradient-to-br from-orange-50 to-amber-100 p-8 flex items-center justify-center">
        <div className="text-xl text-gray-700">Loading weather data for Coon Rapids, IA...</div>
      </div>
    );
  }

  if (error) {
    return (
      <div className="min-h-screen bg-gradient-to-br from-orange-50 to-amber-100 p-8">
        <div className="max-w-6xl mx-auto bg-white rounded-lg shadow-lg p-8">
          <div className="text-red-600 text-lg mb-4">Unable to load weather data</div>
          <p className="text-gray-600 mb-4">Error: {error}</p>
          <button 
            onClick={fetchWeatherData}
            className="bg-orange-500 text-white px-6 py-2 rounded hover:bg-orange-600"
          >
            Retry
          </button>
        </div>
      </div>
    );
  }

  const conditions = calculateBurnConditions();
  const temp = weatherData.temperature.value ? celsiusToFahrenheit(weatherData.temperature.value) : null;
  const humidity = weatherData.relativeHumidity.value;
  const windSpeed = weatherData.windSpeed.value ? metersPerSecondToMph(weatherData.windSpeed.value) : null;
  const windDirection = weatherData.windDirection.value;
  const visibility = weatherData.visibility.value ? (weatherData.visibility.value / 1609.34) : null;

  return (
    <div className="min-h-screen bg-gradient-to-br from-orange-50 to-amber-100 p-4 md:p-8">
      <div className="max-w-6xl mx-auto">
        <header className="mb-8">
          <div className="flex items-center gap-3 mb-2">
            <Flame className="w-8 h-8 text-orange-600" />
            <h1 className="text-3xl font-bold text-gray-800">Prescribed Burn Weather Dashboard</h1>
          </div>
          <p className="text-gray-600">Coon Rapids, Iowa • Last updated: {new Date(weatherData.timestamp).toLocaleString()}</p>
          <p className="text-sm text-gray-500 mt-1">Data source: <a href="https://www.weather.gov" target="_blank" rel="noopener noreferrer" className="text-blue-600 hover:underline">National Weather Service (NOAA)</a></p>
        </header>

        <div className={`${conditions.color} text-white rounded-lg p-6 mb-6 shadow-lg`}>
          <div className="flex items-center justify-between">
            <div>
              <h2 className="text-2xl font-bold mb-2">Burn Conditions: {conditions.status}</h2>
              <p className="text-lg">{conditions.message}</p>
              {conditions.issues && conditions.issues.length > 0 && (
                <div className="mt-3">
                  <p className="font-semibold mb-1">Considerations:</p>
                  <ul className="list-disc ml-5">
                    {conditions.issues.map((issue, idx) => (
                      <li key={idx}>{issue}</li>
                    ))}
                  </ul>
                </div>
              )}
            </div>
            <AlertTriangle className="w-16 h-16 opacity-80" />
          </div>
        </div>

        <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
          {/* Temperature Card */}
          <div className="bg-white rounded-lg p-6 shadow-md">
            <div className="flex items-center gap-3 mb-4">
              <Thermometer className="w-6 h-6 text-red-500" />
              <h3 className="font-semibold text-gray-700">Temperature</h3>
            </div>
            <p className="text-4xl font-bold text-gray-800 mb-4">
              {temp ? `${Math.round(temp)}°F` : 'N/A'}
            </p>
            
            {/* Visual Range Indicator */}
            <div className="relative h-12 mb-2">
              {/* Color gradient bar */}
              <div className="absolute w-full h-8 rounded flex">
                <div className="bg-red-500 h-full rounded-l" style={{width: '28%'}}></div>
                <div className="bg-yellow-500 h-full" style={{width: '16%'}}></div>
                <div className="bg-green-500 h-full" style={{width: '20%'}}></div>
                <div className="bg-yellow-500 h-full" style={{width: '16%'}}></div>
                <div className="bg-red-500 h-full rounded-r" style={{width: '20%'}}></div>
              </div>
              
              {/* Current position marker */}
              {temp && (
                <div 
                  className="absolute top-0 h-12 flex flex-col items-center"
                  style={{left: `${Math.min(Math.max(((temp - 20) / 80) * 100, 0), 100)}%`, transform: 'translateX(-50%)'}}
                >
                  <div className="w-1 h-8 bg-gray-800"></div>
                  <div className="w-4 h-4 bg-gray-800 rounded-full border-2 border-white"></div>
                </div>
              )}
            </div>
            
            {/* Range labels */}
            <div className="flex justify-between text-xs text-gray-600 mb-2">
              <span>20°</span>
              <span className="text-red-600 font-semibold">35°</span>
              <span className="text-green-600 font-semibold">45°</span>
              <span className="text-green-600 font-semibold">65°</span>
              <span className="text-red-600 font-semibold">75°</span>
              <span>100°</span>
            </div>
            <p className="text-xs text-gray-500">
              Dew point: {weatherData.dewpoint.value ? `${Math.round(celsiusToFahrenheit(weatherData.dewpoint.value))}°F` : 'N/A'}
            </p>
          </div>

          {/* Humidity Card */}
          <div className="bg-white rounded-lg p-6 shadow-md">
            <div className="flex items-center gap-3 mb-4">
              <Droplets className="w-6 h-6 text-blue-500" />
              <h3 className="font-semibold text-gray-700">Humidity</h3>
            </div>
            <p className="text-4xl font-bold text-gray-800 mb-4">
              {humidity ? `${Math.round(humidity)}%` : 'N/A'}
            </p>
            
            {/* Visual Range Indicator */}
            <div className="relative h-12 mb-2">
              {/* Color gradient bar */}
              <div className="absolute w-full h-8 rounded flex">
                <div className="bg-red-500 h-full rounded-l" style={{width: '20%'}}></div>
                <div className="bg-yellow-500 h-full" style={{width: '5%'}}></div>
                <div className="bg-green-500 h-full" style={{width: '30%'}}></div>
                <div className="bg-yellow-500 h-full" style={{width: '5%'}}></div>
                <div className="bg-red-500 h-full rounded-r" style={{width: '40%'}}></div>
              </div>
              
              {/* Current position marker */}
              {humidity && (
                <div 
                  className="absolute top-0 h-12 flex flex-col items-center"
                  style={{left: `${Math.min(Math.max(humidity, 0), 100)}%`, transform: 'translateX(-50%)'}}
                >
                  <div className="w-1 h-8 bg-gray-800"></div>
                  <div className="w-4 h-4 bg-gray-800 rounded-full border-2 border-white"></div>
                </div>
              )}
            </div>
            
            {/* Range labels */}
            <div className="flex justify-between text-xs text-gray-600 mb-2">
              <span>0%</span>
              <span className="text-red-600 font-semibold">20%</span>
              <span className="text-green-600 font-semibold">25%</span>
              <span className="text-green-600 font-semibold">55%</span>
              <span className="text-red-600 font-semibold">60%</span>
              <span>100%</span>
            </div>
            <p className="text-xs text-gray-500">
              Pressure: {weatherData.barometricPressure.value ? `${(weatherData.barometricPressure.value / 100).toFixed(1)} mb` : 'N/A'}
            </p>
          </div>

          {/* Wind Card with Professional Flow Map */}
          <div className="bg-white rounded-lg p-6 shadow-md col-span-1 md:col-span-2">
            <div className="flex items-center justify-between mb-4">
              <div className="flex items-center gap-3">
                <Wind className="w-6 h-6 text-teal-500" />
                <h3 className="font-semibold text-gray-700">Wind Flow Map</h3>
              </div>
              <div className="text-right">
                <p className="text-3xl font-bold text-gray-800">
                  {windSpeed ? `${Math.round(windSpeed)} mph` : 'N/A'}
                </p>
                <p className="text-sm text-gray-500">
                  {getWindDirection(windDirection)} {windDirection ? `${Math.round(windDirection)}°` : ''}
                </p>
              </div>
            </div>
            
            {/* Professional Wind Flow Map */}
            <div 
              className="relative bg-gradient-to-br from-slate-800 via-slate-700 to-slate-900 rounded-lg overflow-hidden border-2 border-gray-300 cursor-move"
              style={{ height: '400px' }}
              onMouseDown={handleMouseDown}
              onMouseMove={handleMouseMove}
              onMouseUp={handleMouseUp}
              onMouseLeave={handleMouseUp}
              onTouchStart={handleTouchStart}
              onTouchMove={handleTouchMove}
              onTouchEnd={handleTouchEnd}
            >
              {/* Grid overlay */}
              <svg className="absolute inset-0 w-full h-full pointer-events-none opacity-20">
                <defs>
                  <pattern id="grid" width="40" height="40" patternUnits="userSpaceOnUse">
                    <path d="M 40 0 L 0 0 0 40" fill="none" stroke="white" strokeWidth="0.5"/>
                  </pattern>
                </defs>
                <rect width="100%" height="100%" fill="url(#grid)" />
              </svg>
              
              {/* Topographic style contours */}
              <svg className="absolute inset-0 w-full h-full pointer-events-none opacity-10">
                <circle cx="50%" cy="30%" r="60" fill="none" stroke="white" strokeWidth="1"/>
                <circle cx="50%" cy="30%" r="100" fill="none" stroke="white" strokeWidth="1"/>
                <circle cx="50%" cy="30%" r="140" fill="none" stroke="white" strokeWidth="1"/>
                <circle cx="70%" cy="60%" r="80" fill="none" stroke="white" strokeWidth="1"/>
                <circle cx="30%" cy="70%" r="50" fill="none" stroke="white" strokeWidth="1"/>
              </svg>
              
              {/* Map content container */}
              <div 
                className="absolute inset-0"
                style={{ 
                  transform: `translate(${mapOffset.x}px, ${mapOffset.y}px)`,
                  transition: isDragging ? 'none' : 'transform 0.2s ease-out'
                }}
              >
                {/* Wind particles - dense field */}
                {windSpeed && windDirection && windParticles.map((particle) => {
                  const angle = windDirection * (Math.PI / 180);
                  const speed = windSpeed * 2;
                  const length = 30 + (windSpeed * 1.5);
                  
                  const endX = particle.startX + Math.sin(angle) * length;
                  const endY = particle.startY - Math.cos(angle) * length;
                  
                  return (
                    <svg
                      key={particle.id}
                      className="absolute pointer-events-none"
                      style={{
                        left: `${particle.startX}px`,
                        top: `${particle.startY}px`,
                        width: '2px',
                        height: `${length}px`,
                        animation: `windParticle 4s ease-in-out infinite`,
                        animationDelay: `${particle.delay}s`
                      }}
                    >
                      <line
                        x1="1"
                        y1="0"
                        x2={Math.sin(angle) * length + 1}
                        y2={-Math.cos(angle) * length + length}
                        stroke="rgba(94, 234, 212, 0.6)"
                        strokeWidth="1.5"
                        strokeLinecap="round"
                      />
                    </svg>
                  );
                })}
                
                {/* Location markers */}
                <div className="absolute" style={{ left: '50%', top: '50%', transform: 'translate(-50%, -50%)' }}>
                  <div className="relative">
                    <div className="w-4 h-4 bg-red-500 rounded-full border-2 border-white shadow-lg animate-pulse"></div>
                    <div className="absolute -bottom-6 left-1/2 transform -translate-x-1/2 whitespace-nowrap">
                      <div className="bg-black bg-opacity-75 text-white text-xs px-2 py-1 rounded">
                        Coon Rapids
                      </div>
                    </div>
                  </div>
                </div>
                
                {/* Nearby location markers */}
                <div className="absolute" style={{ left: '35%', top: '35%', transform: 'translate(-50%, -50%)' }}>
                  <div className="w-2 h-2 bg-blue-400 rounded-full border border-white"></div>
                  <div className="absolute -bottom-5 left-1/2 transform -translate-x-1/2 whitespace-nowrap">
                    <div className="bg-black bg-opacity-60 text-white text-xs px-1.5 py-0.5 rounded text-center">
                      Carroll
                    </div>
                  </div>
                </div>
                
                <div className="absolute" style={{ left: '65%', top: '45%', transform: 'translate(-50%, -50%)' }}>
                  <div className="w-2 h-2 bg-blue-400 rounded-full border border-white"></div>
                  <div className="absolute -bottom-5 left-1/2 transform -translate-x-1/2 whitespace-nowrap">
                    <div className="bg-black bg-opacity-60 text-white text-xs px-1.5 py-0.5 rounded">
                      Jefferson
                    </div>
                  </div>
                </div>
                
                <div className="absolute" style={{ left: '50%', top: '70%', transform: 'translate(-50%, -50%)' }}>
                  <div className="w-2 h-2 bg-blue-400 rounded-full border border-white"></div>
                  <div className="absolute -bottom-5 left-1/2 transform -translate-x-1/2 whitespace-nowrap">
                    <div className="bg-black bg-opacity-60 text-white text-xs px-1.5 py-0.5 rounded">
                      Bayard
                    </div>
                  </div>
                </div>
              </div>
              
              {/* Compass rose */}
              <div className="absolute top-4 right-4 w-16 h-16 pointer-events-none">
                <svg viewBox="0 0 100 100" className="w-full h-full">
                  <circle cx="50" cy="50" r="48" fill="rgba(0,0,0,0.5)" stroke="white" strokeWidth="2"/>
                  <text x="50" y="20" textAnchor="middle" fill="white" fontSize="16" fontWeight="bold">N</text>
                  <text x="50" y="90" textAnchor="middle" fill="white" fontSize="14">S</text>
                  <text x="15" y="55" textAnchor="middle" fill="white" fontSize="14">W</text>
                  <text x="85" y="55" textAnchor="middle" fill="white" fontSize="14">E</text>
                  <line x1="50" y1="10" x2="50" y2="30" stroke="red" strokeWidth="2"/>
                </svg>
              </div>
              
              {/* Map legend */}
              <div className="absolute bottom-4 left-4 bg-black bg-opacity-75 text-white text-xs px-3 py-2 rounded">
                <div className="flex items-center gap-2 mb-1">
                  <div className="w-3 h-0.5 bg-teal-300"></div>
                  <span>Wind Flow</span>
                </div>
                <div className="flex items-center gap-2">
                  <div className="w-3 h-3 bg-red-500 rounded-full"></div>
                  <span>Your Location</span>
                </div>
                <div className="text-gray-400 mt-2 text-xs">
                  Drag to pan • Scroll to explore
                </div>
              </div>
              
              {/* Reset view button */}
              <button
                onClick={() => setMapOffset({ x: 0, y: 0 })}
                className="absolute top-4 left-4 bg-black bg-opacity-75 text-white text-xs px-3 py-1.5 rounded hover:bg-opacity-90 transition-all"
              >
                Reset View
              </button>
            </div>
            
            {/* Visual Range Indicator */}
            <div className="relative h-12 mb-2 mt-4">
              <div className="absolute w-full h-8 rounded flex">
                <div className="bg-red-500 h-full rounded-l" style={{width: '10%'}}></div>
                <div className="bg-yellow-500 h-full" style={{width: '10%'}}></div>
                <div className="bg-green-500 h-full" style={{width: '25%'}}></div>
                <div className="bg-yellow-500 h-full" style={{width: '12.5%'}}></div>
                <div className="bg-red-500 h-full rounded-r" style={{width: '42.5%'}}></div>
              </div>
              
              {windSpeed && (
                <div 
                  className="absolute top-0 h-12 flex flex-col items-center"
                  style={{left: `${Math.min(Math.max((windSpeed / 40) * 100, 0), 100)}%`, transform: 'translateX(-50%)'}}
                >
                  <div className="w-1 h-8 bg-gray-800"></div>
                  <div className="w-4 h-4 bg-gray-800 rounded-full border-2 border-white"></div>
                </div>
              )}
            </div>
            
            <div className="flex justify-between text-xs text-gray-600">
              <span>0</span>
              <span className="text-red-600 font-semibold">3</span>
              <span className="text-green-600 font-semibold">5</span>
              <span className="text-green-600 font-semibold">15</span>
              <span className="text-red-600 font-semibold">20</span>
              <span>40 mph</span>
            </div>
          </div>

          {/* Visibility Card */}
          <div className="bg-white rounded-lg p-6 shadow-md">
            <div className="flex items-center gap-3 mb-4">
              <Eye className="w-6 h-6 text-purple-500" />
              <h3 className="font-semibold text-gray-700">Visibility</h3>
            </div>
            <p className="text-4xl font-bold text-gray-800 mb-4">
              {visibility ? `${visibility.toFixed(1)} mi` : 'N/A'}
            </p>
            
            {/* Visual Range Indicator */}
            <div className="relative h-12 mb-2">
              {/* Color gradient bar */}
              <div className="absolute w-full h-8 rounded flex">
                <div className="bg-red-500 h-full rounded-l" style={{width: '20%'}}></div>
                <div className="bg-yellow-500 h-full" style={{width: '10%'}}></div>
                <div className="bg-green-500 h-full rounded-r" style={{width: '70%'}}></div>
              </div>
              
              {/* Current position marker */}
              {visibility && (
                <div 
                  className="absolute top-0 h-12 flex flex-col items-center"
                  style={{left: `${Math.min(Math.max((visibility / 10) * 100, 0), 100)}%`, transform: 'translateX(-50%)'}}
                >
                  <div className="w-1 h-8 bg-gray-800"></div>
                  <div className="w-4 h-4 bg-gray-800 rounded-full border-2 border-white"></div>
                </div>
              )}
            </div>
            
            {/* Range labels */}
            <div className="flex justify-between text-xs text-gray-600 mb-2">
              <span>0 mi</span>
              <span className="text-red-600 font-semibold">2</span>
              <span className="text-green-600 font-semibold">3+</span>
              <span>10 mi</span>
            </div>
            <p className="text-xs text-gray-500">
              {weatherData.textDescription || 'Clear'}
            </p>
          </div>
        </div>

        {forecast && forecast.length > 0 && (
          <div className="bg-white rounded-lg p-6 shadow-md">
            <h3 className="text-xl font-bold text-gray-800 mb-4">12-Hour Forecast</h3>
            <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4">
              {forecast.slice(0, 6).map((period, idx) => {
                const time = new Date(period.startTime);
                return (
                  <div key={idx} className="border border-gray-200 rounded p-3">
                    <p className="text-sm font-semibold text-gray-700">
                      {time.toLocaleTimeString([], {hour: 'numeric'})}
                    </p>
                    <p className="text-2xl font-bold text-gray-800 mt-1">{period.temperature}°</p>
                    <div className="flex items-center gap-1 mt-2 text-sm text-gray-600">
                      <Droplets className="w-4 h-4" />
                      <span>{period.relativeHumidity.value}%</span>
                    </div>
                    <div className="flex items-center gap-1 mt-1 text-sm text-gray-600">
                      <Wind className="w-4 h-4" />
                      <span>{period.windSpeed}</span>
                    </div>
                    <p className="text-xs text-gray-500 mt-2">{period.shortForecast}</p>
                  </div>
                );
              })}
            </div>
          </div>
        )}

        <div className="bg-amber-50 border-l-4 border-amber-500 p-4 mt-6 rounded">
          <div className="flex items-start gap-3">
            <AlertTriangle className="w-5 h-5 text-amber-600 mt-0.5 flex-shrink-0" />
            <div className="text-sm text-gray-700">
              <p className="font-semibold mb-1">Safety Reminder</p>
              <p>Always consult with local fire authorities and obtain proper permits before conducting a prescribed burn. Weather conditions can change rapidly. Monitor conditions continuously during burn operations.</p>
            </div>
          </div>
        </div>

        <button 
          onClick={fetchWeatherData}
          className="mt-4 bg-orange-500 text-white px-6 py-2 rounded hover:bg-orange-600 transition-colors"
        >
          Refresh Data
        </button>
      </div>
    </div>
  );
};

ReactDOM.render(<PrescribedBurnDashboard />, document.getElementById('root'));
    </script>
</body>
</html>
